<template name="mdMyAccount">
  <div class="row">
    <div class="col-xs-12"><h2>Hi, {{user.profile.firstname}}!</h2></div>
  </div>
  <br />
  <div class="row">
    <div class="col-xs-12"><h3>Your Orders</h3></div>
  </div>

  <div class="row">
    <div class="col-xs-12">
      <div class="table-responsive">
        <table class="table table-striped">
          <tbody>
            {{#each orders}}
              {{> mdMyAccountOrder}} 
            {{/each}}
          </tbody>
        </table>
          
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-sm-5">
      <h3>Account Information</h3><hr />
        {{> mdMyAccountUserForm}}
    </div>
    <div class="col-sm-7">
      <h3>Shipping Information</h3><hr />
        {{> mdMyAccountShippingForm}}
    </div>
  </div>

  <div class="row">
    <div class="col-xs-12">
      <h3>Data Permissions</h3><hr />
        {{> mdMyAccountDataPermissions}}
    </div>
  </div>

    {{> mdTrack}}

</template>

<template name="mdMyAccountOrder">
  {{#if show status}}
    <tr>
      <td>{{dateFormat createdAt format="MM/DD/YY"}}</td>
      <td>Order {{orderNumber}}</td>
      <td>{{archiveType}}</td>
      <td>${{price}}</td> 
        {{#if isEqual status "Shipped"}}
          <td><a href="#" value="{{trackingId}}" >{{status}}</a></td>
        {{else}}
          <td>{{status}}</td>
        {{/if}}
    </tr>
       
  {{/if}}
  
</template>


<template name="mdMyAccountUserForm">
  {{#with userdet}}
   {{#if services.google}} 
     <strong>You are using Google to login.</strong> 
   {{else}}
   
     <form id="account-manage-form" class="form-horizontal">
        {{#if succmessage}}
       <div id="chsuccess" class="alert alert-success">
         <strong>Success!</strong> Your password successfully changed.
       </div>
        {{/if}}
         {{#if showcurrerror}}
       <div id="cherror" class="alert alert-danger ">
         <strong>Failed!</strong> Incorrect current password.
       </div>
         {{/if}}
         {{#if showpwderror}}
       <div id="passmatch" class="alert alert-warning ">
         <strong>Warning!</strong> These Passwords don't match. Please try again.
       </div>
         {{/if}}
         {{#if passwdstrength}}
       <div id="chpwd" class="alert alert-warning ">
         <strong>Warning!</strong> Password length must be between 6-20.
       </div>
         {{/if}}
         {{#if passwdstrengths}}
       <div id="chpwd" class="alert alert-warning ">
         <strong>Warning!</strong> Password must contain one character and one number.
       </div>
         {{/if}}
       <div class="form-group">
         <label for="txtEmail" class="col-md-5 control-label">Email</label>   
           <div class="col-md-7">
             {{#each emails}}
               <input type="email" class="form-control" name="txtEmail" value="{{address}}" readonly placeholder="Email">
             {{/each}}
           </div>
       </div>
       <div class="form-group">
         <div class="col-xs-12">(6-20 character password, min. one letter and one number required)</div>
       </div>
       <div id="currsucc" class="form-group">
         <label for="txtPassword" class="col-md-5 control-label">Current Password</label>   
       <div class="col-md-7">
         <input type="password" class="form-control" name="txtPassword" placeholder="Current Password">
       </div>
       </div>
       <div class="form-group">
         <label for="txtNewpassword" class="col-md-5 control-label">New Password</label>   
       <div class="col-md-7">
         <input type="password" class="form-control" name="txtNewpassword" placeholder="New Password">
       </div>
       </div>
       <div class="form-group">
         <label for="txtRepassword" class="col-md-5 control-label">Re-enter Password</label>   
           <div class="col-md-7">
             <input type="password" class="form-control" name="txtRepassword" placeholder="Re-enter Password">
           </div>
       </div>
       <div class="form-group">
         <div class="col-md-offset-7 col-md-5">
           <button type="submit" id="btChangePassword" class=" btn btn-primary btn-block">Update</button>
         </div>
       </div>
     </form>
   {{/if}}
  {{/with}}

</template>

<template name="mdMyAccountShippingForm">
  <form id="shipping-address-form" class="form-horizontal col-md-12">
    <div class="alert alert-danger address-errors" role="alert" style="display: none;"></div>
      <div class="form-group">
        <label for="name" class="col-md-3 control-label">Name</label>
        <div class="col-md-9">
          <input type="text" class="form-control" id="name" name="name" placeholder="Name" value="{{user.profile.shipTo.name}}">
        </div>
      </div>

      {{> mdAddress}}

      <div class="form-group">
        <div class="col-md-offset-8 col-md-4">
          <button type="submit" class="btn btn-primary btn-block">Update</button>
        </div>
      </div>
  </form>
</template>

<template name="mdMyAccountDataPermissions">
  <div class="row">
    <div class="col-sm-3">
      <img src="/images/google_200px.png" class="img-responsive" />
    </div>
    <div class="col-sm-3 data-permission-content">
       Status: Connected!
    </div>
    <div class="col-sm-3 data-permission-content">
        Access to Google Drive, Picasa <br />
        Read/Write permissions <br />
        Basic account info <br />
    </div>
    <div class="col-sm-3 data-permission-content">
        <a href="#">Revoke Permissions</a>
    </div>
  </div>
</template>

<template name="mdTrack">
   <div class="modal fade" id="mdTrack" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" >
     <div class="modal-dialog" role="document">
       <div class="modal-content">
         <div class="modal-header">
           <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
           <h4 class="modal-title" id="myModalLabel">Shipping Status</h4>
         </div>
       <div class="modal-body">
    
         <div style="display: inline-table;">
           <p>
             {{#if showspinner}}
               {{> spinner}}
             {{/if}} 
           </p>
         </div>
         {{#if trackerror}}
           <div id="passmatch" class="alert alert-danger ">
             <strong>Warning!</strong>Corresponding Tracking Code Not Found.
           </div>
         {{/if}}
           
         {{#if trackdata}}
           {{#with trackdata}}
             <div class="track">
               <table class="table ">
               <tr>
                 <td class="bold">Carrier</td>
                 <td>{{carrier}}</td>
               </tr>
               <tr>
                 <td class="bold">Tracking Number</td>
                 <td>{{tracking_code}}</td>
               </tr>
               <tr>
                 <td class="bold">Estimated Delivery </td>
                 <td>{{est_delivery_date}}</td>
               </tr>
               <tr>
                 <td class="bold">Current Status</td>
                  {{#if isEqual status "in_transit"}}
                 <td>{{isEqual}}</td>
                  {{else}}
                    <td>{{isEqual}}</td>
                  {{/if}}
               </tr>
               <tr>
                 <td class="bold">Last Update</td>
                 <td>{{updated_at}}</td>
               </tr>
               <tr><hr></tr>
              
               </table>
             </div>
           <div id="footer" class="modal-footer" >
           <button type="button"  class=" btn btn-primary btn-block" data-dismiss="modal">Close</button>
         </div>
           <div>
                <div class="panel panel-default">
                  <div class="panel-heading">Details</div>

                  {{#each tracking_details}}
                    <div class="trackdata" >{{message}}</div>
                    <hr>
                  {{/each}}

                </div>
           </div>
           
           {{/with}} 
           
           
         {{/if}} 
         <div>
             
         </div>
       </div> 
        
       </div> 
     
     </div>
   </div>
    
</template>

